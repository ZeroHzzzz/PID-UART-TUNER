# PID调参工具通信协议文档

## 协议概述
本协议用于通过串口传输PID参数到底盘控制系统，支持三种控制环路的参数调节。

## 数据帧格式
```
+--------+--------+------+--------+--------+--------+----------+--------+--------+
| 帧头1  | 帧头2  | 类型 |   P    |   I    |   D    |  校验和  | 帧尾1  | 帧尾2  |
+--------+--------+------+--------+--------+--------+----------+--------+--------+
| 0xAA   | 0x55   | 1字节| 4字节  | 4字节  | 4字节  |  1字节   | 0x55   | 0xAA   |
+--------+--------+------+--------+--------+--------+----------+--------+--------+
```

总长度：16字节

## 字段说明

### 1. 帧头 (2字节)
- 固定值：0xAA 0x55
- 用于帧同步和数据包识别

### 2. 参数类型 (1字节)
- 0x01: 角速度环PID参数
- 0x02: 角度环PID参数  
- 0x03: 速度环PID参数

### 3. PID参数 (12字节)
- P参数：4字节IEEE754单精度浮点数，小端序
- I参数：4字节IEEE754单精度浮点数，小端序
- D参数：4字节IEEE754单精度浮点数，小端序

### 4. 校验和 (1字节)
- 计算方法：(类型字节 + P的4字节 + I的4字节 + D的4字节) 的和 & 0xFF

### 5. 帧尾 (2字节)
- 固定值：0x55 0xAA
- 用于帧结束标识

## 参数范围建议

### 角速度环
- P: 0.1 ~ 50.0 (推荐起始值: 10.0)
- I: 0.0 ~ 5.0  (推荐起始值: 0.1)
- D: 0.0 ~ 2.0  (推荐起始值: 0.01)

### 角度环  
- P: 0.1 ~ 20.0 (推荐起始值: 5.0)
- I: 0.0 ~ 2.0  (推荐起始值: 0.05)
- D: 0.0 ~ 1.0  (推荐起始值: 0.1)

### 速度环
- P: 0.1 ~ 30.0 (推荐起始值: 8.0)
- I: 0.0 ~ 3.0  (推荐起始值: 0.2)
- D: 0.0 ~ 1.5  (推荐起始值: 0.05)

## 使用流程

1. 连接串口（推荐115200波特率）
2. 在界面上调整PID参数
3. 点击"发送"按钮发送单个环路参数
4. 或点击"发送所有参数"一次性发送所有参数
5. 观察底盘响应效果
6. 根据效果调整参数并重新发送

## 调参建议

### 调参顺序
1. 首先调节角速度环（内环）
2. 然后调节角度环（外环）
3. 最后调节速度环

### 调参方法
1. **P参数调节**：从小到大逐步增加，直到系统响应足够快但不震荡
2. **I参数调节**：用于消除稳态误差，过大会导致超调和震荡
3. **D参数调节**：用于改善动态性能，减少超调，但过大会放大噪声

### 现象分析
- **震荡**: P过大或D过小
- **响应慢**: P过小
- **稳态误差**: I过小
- **超调大**: I过大或D过小
- **噪声大**: D过大

## 数据包示例

发送角速度环参数 P=10.0, I=0.1, D=0.01：
```
AA 55 01 00 00 20 41 CD CC CC 3D 23 DB 23 3C B5 55 AA
```

解析：
- AA 55: 帧头
- 01: 角速度环类型
- 00 00 20 41: P=10.0 (IEEE754)
- CD CC CC 3D: I=0.1 (IEEE754)  
- 23 DB 23 3C: D=0.01 (IEEE754)
- B5: 校验和
- 55 AA: 帧尾